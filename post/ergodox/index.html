<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title> ErgoDoxEZキーボードを導入する &middot; SE Can&#39;t Code </title>


<link rel="stylesheet" href="https://sott0n.github.iocss/slim.css">
<link rel="stylesheet" href="https://sott0n.github.iocss/highlight.min.css">
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro' rel='stylesheet' type='text/css'>

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">


<link href="" rel="alternate" type="application/rss+xml" title="SE Can&#39;t Code" />

</head>

<body>
  <div class="container">
    <div class="header">
  <h1 class="site-title"><a href="https://sott0n.github.io">SE Can&#39;t Code</a></h1>
  <p class="site-tagline">I&#39;m Software Engineer, not System Engineer.</p>
  <div class="nav">
    <a class="nav-btn" href="#">
      <span class="ci ci-burger"></span>
    </a>
    <ul class="nav-list">
       
	  <li class="spacer">&ac;</li>

      <li><a href="https://github.com/sott0n">Github</a></li>  
    </ul>
  </div>
</div>
    <div class="content">
      <div class="posts">
        <div class="post">
          <h2 class="post-title"><a href="https://sott0n.github.io/post/ergodox/">ErgoDoxEZキーボードを導入する</a></h2>
          <span class="post-date">Apr 14, 2019 </span>
          <div class="post-content">
            <p><img src="/image/ergodox_ez.jpg" alt="image"></p>
<p>分割エルゴノミクスキーボードで有名なErgoDox EZを導入したのでその設定方法についてメモを残そうと思う。
画像のものは自宅だが、自分はこのキーボードを職場用として使っている。端的に言うと、ErgoDoxサイコーなのでプログラマーはぜひ導入しましょう。</p>
<h2 id="tldr">tl;dr</h2>
<p>ErgoDox EZの感想を述べると、</p>
<ul>
<li>ErgoDox EZの設定自体はそんなに難しくない</li>
<li>ただしJISキーボードを想定する場合は結構辛い</li>
<li>自分好みにキーバインドが設定できるのでかなり楽しい</li>
</ul>
<p>慣れるまで大変だけれど、3日もすれば余裕で慣れるし、そのあとはプログラミングがかなり楽になるのでオススメ。</p>
<h2 id="ergodox-ezとは">ErgoDox EZとは</h2>
<p>ErgoDoxはキーボードの設計とソースコードをオープンにしているプロジェクトで、ErgoDox EZはそれを製品として販売しているものになる。</p>
<p><a href="https://www.indiegogo.com/projects/ergodox-ez-an-incredible-mechanical-keyboard#/">https://www.indiegogo.com/projects/ergodox-ez-an-incredible-mechanical-keyboard#/</a></p>
<p>自由にキーバインドをカスタマイズできたり、キー自体を色々自分で変えて遊んでみたりとプログラマーがオリジナルで自分のキーボードを作れて楽しめるような製品になっている。
購入すると海の向こう側から配送してもらうことになるのだが、1~2週間程度で日本の自宅までやってきた記憶がある。</p>
<h2 id="キーバインド条件">キーバインド条件</h2>
<p>ErgoDox EZが手元に届いたらまずやることはキーバインドの設定だろう。本エントリではこのキーバインドの設定についてのみメモを残していく。</p>
<p>自分の場合は下記の条件でキーバインドを設定した:</p>
<ul>
<li>WindowsとMacbookの両方で利用できること</li>
<li>JISキーボードであること</li>
</ul>
<p>自分がなぜ日本人なのだろうかと思うタイミングの一つにJISキーボード縛りがあると思う。
自分の場合、会社の特殊な環境のおかげでUSキーボードが何故か機能しないという現象に合い、仕方なくJISキーボードで設定をする羽目になった。
当然ながらこの手の海外産の製品はUSキーボードが前提になってしまうため、キーバインドも微妙な違いが出てくる。</p>
<p>また、職場がWindowsとMacbookの両方で作業しているので、両方で使えるようにキーバインドするのが結構大変だった。
ErgoDox EZはキーバインド自体をLayerとして複数持つことができ、かつそれらを自由に追加できるので、
Windows用のキーバインドとMacbook用のキーバインドを用意してあげたりもできる。自分は最終的にLayerを一つ追加してOS毎に対応するようにした。</p>
<h2 id="キーバインドの設定方法">キーバインドの設定方法</h2>
<p>ErgoDox EZは<a href="https://www.pjrc.com/teensy/">Teensy USB Development Board </a>と言うソフトウェアを使い、
コンパイルしたファームウェアをキーボードに流し込んでキーバインドを自由に設定することができる。</p>
<p>やり方はシンプルで下記のやり方で設定できる:</p>
<ul>
<li>Teensyをダウンロード</li>
<li>ファームウェアをコンパイルして<code>.hex</code>を生成</li>
<li>Teensyに生成した.hexを流し込む</li>
</ul>
<p>ここではまず、ファームウェアのコンパイル方法から説明する。</p>
<h3 id="ファームウェアのコンパイル">ファームウェアのコンパイル</h3>
<p>まずコンパイルに一通り必要なソフトウェアをインストールする。(MacOS前提)</p>
<pre><code>brew tap osx-cross/avr
brew install avr-libc
brew install dfu-programmer
</code></pre><p>そのあとは、<code>https://github.com/qmk/qmk_firmware/tree/master/keyboards/ergodox_ez</code>のソースコードをダウンロードし、
<code>keymaps/default</code>というディレクトリと同じ場所に自分自身のディレクトリを作成して、default以下の<code>keymap.c</code>と同様のファイルを作成する（コピーして編集するといい）。
それを<code>make KEYMAP=[your_name]</code>でmakeするとコンパイルされたhexファイルが作成される。hexファイルが作成されたらTeensyに読み込ませてキーボードに流し込むとキーバインドが反映される。</p>
<p>自分で<code>keymap.c</code>を編集するのが一番自由度が高くて良いが、一番手っ取り早いやり方にGUI上でキーバインドを設定してhexファイルを生成する方法がある。</p>
<p><a href="https://configure.ergodox-ez.com/layouts/default/latest/0">https://configure.ergodox-ez.com/layouts/default/latest/0</a></p>
<p>このサイトではGUIベースでキーバインドを決めれるのでとても楽に直感で設定ができる。また、<code>Print layout</code>から印刷もできるのでキーバインドを覚えるように印刷するのがオススメ。</p>
<h3 id="jisキーボード設定">JISキーボード設定</h3>
<p>さて、ここから自分が一番苦労したところである、JISキーボードの設定を書く。
書くといっても答えはシンプルで、USキーボードとは割当てられているキーがJISとは違うので変換して登録をしてあげるだけである。
たとえば、JISの場合の<code>@</code>はUSの場合だと<code>[</code>と打刻される。このように微妙に配列が違う箇所があるので、hexを生成する際にこの差分を吸収してあげないといけない。</p>
<p>JISキーボードとUSキーボードの違いは下記の通りである:</p>
<table>
<thead>
<tr>
<th>JIS</th>
<th>US</th>
<th>JIS(Shift)</th>
<th>US(Shift)</th>
<th>Ergodox</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>!</td>
<td>!</td>
<td>KC_1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>&quot;</td>
<td>@</td>
<td>KC_2</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>#</td>
<td>#</td>
<td>KC_3</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>$</td>
<td>$</td>
<td>KC_4</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
<td>%</td>
<td>%</td>
<td>KC_5</td>
</tr>
<tr>
<td>6</td>
<td>6</td>
<td>&amp;</td>
<td>^</td>
<td>KC_6</td>
</tr>
<tr>
<td>7</td>
<td>7</td>
<td>'</td>
<td>&amp;</td>
<td>KC_7</td>
</tr>
<tr>
<td>8</td>
<td>8</td>
<td>(</td>
<td>*</td>
<td>KC_8</td>
</tr>
<tr>
<td>9</td>
<td>9</td>
<td>)</td>
<td>(</td>
<td>KC_9</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>無</td>
<td>)</td>
<td>KC_0</td>
</tr>
<tr>
<td>-</td>
<td>-</td>
<td>=</td>
<td>_</td>
<td>KC_MINS</td>
</tr>
<tr>
<td>^</td>
<td>=</td>
<td>~</td>
<td>+</td>
<td>KC_EQL</td>
</tr>
<tr>
<td>\</td>
<td>無</td>
<td>｜</td>
<td>無</td>
<td>KC_JYEN</td>
</tr>
<tr>
<td>@</td>
<td>[</td>
<td>`          | {         | KC_LBRC |</td>
<td></td>
<td></td>
</tr>
<tr>
<td>[</td>
<td>]</td>
<td>{</td>
<td>}</td>
<td>KC_RBRC</td>
</tr>
<tr>
<td>;</td>
<td>;</td>
<td>+</td>
<td>:</td>
<td>KC_SCLN</td>
</tr>
<tr>
<td>:</td>
<td>'</td>
<td>*</td>
<td>&quot;</td>
<td>KC_QUOT</td>
</tr>
<tr>
<td>]</td>
<td>\</td>
<td>}</td>
<td>｜</td>
<td>KC_BSLS</td>
</tr>
<tr>
<td>,</td>
<td>,</td>
<td>&lt;</td>
<td>&lt;</td>
<td>KC_COMM</td>
</tr>
<tr>
<td>.</td>
<td>.</td>
<td>&gt;</td>
<td>&gt;</td>
<td>KC_DOT</td>
</tr>
<tr>
<td>/</td>
<td>/</td>
<td>?</td>
<td>?</td>
<td>KC_SLSH</td>
</tr>
<tr>
<td>\</td>
<td>無</td>
<td>_</td>
<td>無</td>
<td>KC_RO</td>
</tr>
</tbody>
</table>
<p>要するに上記の差分表を意識して、自分の意図するキーバインドを設定してあげると良い。
ErgoDoxの場合はUSキーボード前提なので、言葉の意味合いがJISキーボードの場合だと変わってしまうと言うだけである。
自分はGUIサイトでこの差分表を見ながらJISに合わせて設定をした。結構めんどくさかったが、一度やってしまえば二度とやる作業ではないのでまあ頑張るしかない。</p>
<h2 id="まとめ">まとめ</h2>
<p>JISキーボード対応以外にもファームウェアのRESETボタンを事前にキーバインドに設定しておいたり、
Layer間移動の設定や、英語と日本語の変換などと細かい設定が必要だが、それぞれ自分の好きなところにキーを設定できるのはとてもありがたい。
割と何度もファームウェアの流し込みを繰り返しながら、自分に合うキーバインドを探すことになるがこれは結構楽しかった。</p>
<p>おかげで生産性は上がった気がするので、キーボードはプログラマーにとってやっぱり大事な道具の一つだよなと改めて思う。</p>

          </div>
        </div>
        <div class="pagination"> 
        </div>
      </div>
    </div>
    
    <div class="footer">
  
  <p>Copyright Sott0n 2021. Powered by Hugo.</p>
  
</div>

  </div>
  <script src="https://sott0n.github.iojs/slim.js"></script>
  <script src="https://sott0n.github.iojs/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
</body>

</html>
